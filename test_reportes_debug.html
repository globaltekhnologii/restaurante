<!DOCTYPE html>
<html>
<head>
    <title>Test de Reportes</title>
</head>
<body>
    <h1>Test de APIs de Reportes</h1>
    <div id="results"></div>
    
    <script>
        const resultsDiv = document.getElementById('results');
        
        async function testAPI(url, name) {
            try {
                const response = await fetch(url);
                const text = await response.text();
                
                let data;
                try {
                    data = JSON.parse(text);
                } catch (e) {
                    return `<div style="color: red;"><strong>${name}:</strong> ERROR - Respuesta no es JSON<br><pre>${text.substring(0, 500)}</pre></div>`;
                }
                
                if (data.success) {
                    return `<div style="color: green;"><strong>${name}:</strong> ✓ OK<br><pre>${JSON.stringify(data, null, 2).substring(0, 300)}...</pre></div>`;
                } else {
                    return `<div style="color: orange;"><strong>${name}:</strong> ⚠ Error: ${data.error}</div>`;
                }
            } catch (error) {
                return `<div style="color: red;"><strong>${name}:</strong> ✗ ${error.message}</div>`;
            }
        }
        
        async function runTests() {
            const fecha = new Date().toISOString().split('T')[0];
            
            const tests = [
                testAPI(`api/get_ventas_periodo.php?fecha_inicio=${fecha}&fecha_fin=${fecha}`, 'Ventas Período'),
                testAPI(`api/get_productos_vendidos.php?fecha_inicio=${fecha}&fecha_fin=${fecha}&limite=10`, 'Productos Vendidos'),
                testAPI('api/get_estadisticas_dashboard.php', 'Dashboard'),
                testAPI('api/test_reportes.php', 'Test Diagnóstico')
            ];
            
            const results = await Promise.all(tests);
            resultsDiv.innerHTML = results.join('<hr>');
        }
        
        runTests();
    </script>
</body>
</html>
